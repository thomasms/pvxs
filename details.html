
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Details &#8212; PVXS 0.1.4 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release Notes" href="releasenotes.html" />
    <link rel="prev" title="Examples" href="example.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="details">
<h1>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h1>
<div class="section" id="reporting-a-bug">
<span id="reportbug"></span><h2>Reporting a Bug<a class="headerlink" href="#reporting-a-bug" title="Permalink to this headline">¶</a></h2>
<p>Before reporting a bug, please check to see if this issue has already been <a class="reference external" href="https://github.com/mdavidsaver/pvxs/issues">reported</a>.</p>
<p>When composing a new report, please run the included automatic tests “make runtests” and mention the results.
It is enough to mention “All tests successful.” if this is so.  (see <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">runtests</span></code>)</p>
<p><a class="reference external" href="https://github.com/mdavidsaver/pvxs/issues">Bug reports</a> should always include:</p>
<ul class="simple">
<li>EPICS Base version or VCS commit</li>
<li>PVXS module version or VCS commit</li>
<li>libevent version or VCS commit (running “pvxget -V” shows these)</li>
<li>EPICS host and target archs.  (eg. “linux-x86_64”)</li>
<li>Host OS name and version (eg. run “cat /etc/issue”)</li>
<li>Compiler name and version (eg. run “gcc –version”)</li>
<li>The values of any $EPICS_PVA* environment variables which are set.</li>
<li>Any local/site modifications to PVXS or libevent</li>
<li>Concise instructions for reproducing the issue.</li>
</ul>
<p>Additional information which may be relevant:</p>
<ul class="simple">
<li>Number of network interfaces if more than one.</li>
<li>Whether clients and/or servers are on the same host or different hosts.</li>
<li>Whether clients and/or servers are in the same subnet or different subnets</li>
<li>Whether network traffic crosses between virtual machine(s) and physical host(s).</li>
<li>Firewall rules on UDP traffic to/from port 5075 or TCP connections to port 5074</li>
<li>Any local/site modifications to EPICS Base</li>
</ul>
<p>If the module has built successfully, then running <code class="docutils literal notranslate"><span class="pre">pvxinfo</span> <span class="pre">-D</span></code> will
report much of this information.</p>
<div class="section" id="packet-capture">
<h3>Packet Capture<a class="headerlink" href="#packet-capture" title="Permalink to this headline">¶</a></h3>
<p>Some kinds of issues can be easily reproduced by the reporter, but not by others.
eg. those related to interoperability, site private applications, or “environmental” conditions.
In these cases it may be necessary to capture the troublesome network traffic to file.
This section provides a quick guide for using <a class="reference external" href="http://www.wireshark.org/">Wireshark</a> to do this.</p>
<p>An important concern when providing a packet capture taken on a private network is to
avoid unintentionally capturing unrelated, and potentially sensitive, traffic.</p>
<p>Usage of the <code class="docutils literal notranslate"><span class="pre">pva.lua</span></code> extension found in <a class="reference external" href="https://github.com/mdavidsaver/cashark">cashark</a>
provides a quick way to filter out non-PVA traffic.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wireshark</span> <span class="o">-</span><span class="n">X</span> <span class="n">lua_script</span><span class="p">:</span><span class="n">pva</span><span class="o">.</span><span class="n">lua</span>
</pre></div>
</div>
<p>While Wireshark is running, apply a display filter of <code class="docutils literal notranslate"><span class="pre">pva</span></code> to show only PV Access protocol traffic.
From the <code class="docutils literal notranslate"><span class="pre">File</span></code> menu, select <code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">Specified</span> <span class="pre">Packets</span></code>, then choose to export only displayed packets.
Please also check <code class="docutils literal notranslate"><span class="pre">Compress</span> <span class="pre">with</span> <span class="pre">gzip</span></code>.</p>
<p>If it is necessary to select only a specific PVA exchange, use the
<a class="reference external" href="https://www.wireshark.org/docs/wsug_html_chunked/ChAdvFollowStreamSection.html">Follow TCP Stream</a>
feature to display/export only packets associated with a single TCP connection.
This will result in a display filter expression like <code class="docutils literal notranslate"><span class="pre">tcp.stream</span> <span class="pre">eq</span> <span class="pre">1</span></code>.
When trying to identify a single connection/stream, it may be helpful to apply a filter like <code class="docutils literal notranslate"><span class="pre">pva.pv==&quot;special:pv:name&quot;</span></code>.</p>
<p>If if isn’t convenient to run the full Wireshark GUI when capturing,
the <code class="docutils literal notranslate"><span class="pre">tshark</span></code> CLI utility may be used to capture raw traffic to file.
Display filters like <code class="docutils literal notranslate"><span class="pre">pva.lua</span></code> may not be used during capture,
so it will be necessary to filter again using the GUI on another host to produce a second (cooked) capture file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tshark</span> <span class="o">-</span><span class="n">i</span> <span class="nb">any</span> <span class="o">-</span><span class="n">f</span> <span class="s1">&#39;!port ssh&#39;</span> <span class="o">-</span><span class="n">w</span> <span class="n">raw</span><span class="o">.</span><span class="n">pcapng</span>
<span class="n">gzip</span> <span class="n">raw</span><span class="o">.</span><span class="n">pcapng</span>
<span class="c1"># copy raw.pcapng.gz to another host</span>
<span class="n">wireshark</span> <span class="o">-</span><span class="n">X</span> <span class="n">lua_script</span><span class="p">:</span><span class="n">pva</span><span class="o">.</span><span class="n">lua</span> <span class="n">raw</span><span class="o">.</span><span class="n">pcapng</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p>If is doubt about whether private information has been successfully excluded,
packet capture files may be sent privately to the author by email instead of uploading to github.
The author’s PGP key may be found below.</p>
<p>Please <strong>compress</strong> all capture files uploaded or sent!</p>
</div>
</div>
<div class="section" id="release-policy">
<span id="relpolicy"></span><h2>Release Policy<a class="headerlink" href="#release-policy" title="Permalink to this headline">¶</a></h2>
<p>PVXS Release numbering follows the <a class="reference external" href="https://semver.org/">Semantic Versioning</a>
scheme of MAJOR.MINOR.PATCH with the following amendments.</p>
<ul class="simple">
<li>A change to the MAJOR number indicates that a backwards incompatible change to some part of the API.
This may not effect every user application.
This policy is intended to provide users with confidence in upgrading when MAJOR does not change.</li>
<li>The PATCH number will only be incremented if changes to the public API are believed to maintain ABI compatibility.
MINOR will be incremented when a known ABI incompatible change is made.
Library SONAMES take the form MAJOR.MINOR.</li>
<li>At this time only one version number is maintained, which is applied to both
the main libpvxs.so and the auxiliary libpvxsIoc.so.
Statements about API or ABI compatibility apply to both libraries as a group.</li>
</ul>
<p id="pgpkey">Each release will be accompanied by a signed tag in the repository,
which may be verified with the author’s GPG key
<a class="reference external" href="http://keys.gnupg.net/pks/lookup?op=get&amp;search=0x5C159E669D69E2D4C4E74E540C8E1C8347330CFB">5C159E669D69E2D4C4E74E540C8E1C8347330CFB</a>.</p>
</div>
<div class="section" id="contributing">
<span id="contrib"></span><h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>The recommended path for including changes is through <a class="reference external" href="https://github.com/mdavidsaver/pvxs/pulls">Pull Request</a>.</p>
<p>When changing c++ code please do:</p>
<ul class="simple">
<li>Indent with 4 spaces.  No hard tabs.  UNIX style EoL.</li>
<li>Try to maintain the style of surrounding code.</li>
<li>Include meaningful code comments where reasonable.</li>
<li>Add doxygen tags <code class="docutils literal notranslate"><span class="pre">&#64;since</span> <span class="pre">UNRELEASED</span></code> or <code class="docutils literal notranslate"><span class="pre">&#64;until</span> <span class="pre">UNRELEASED</span></code> when documenting additions/changes to public APIs.</li>
</ul>
<p>but do not:</p>
<ul class="simple">
<li>Add any c++ global constructors or destructors in the pvxs library.  (Ok in tools, examples, or tests)</li>
</ul>
<p>When committing changes please do:</p>
<ul class="simple">
<li>Include a commit message</li>
<li>Break up changes into multiple commits where reasonable</li>
<li>Include whitespace only changes as separate commits</li>
</ul>
</div>
<div class="section" id="implementation-notes">
<h2>Implementation Notes<a class="headerlink" href="#implementation-notes" title="Permalink to this headline">¶</a></h2>
<p>Misc. notes on design and Implementation.</p>
<ul class="simple">
<li>All Server and client Context instances listening on the same UDP port# within a process
will share a single UDP socket.</li>
<li>The UDP local multicast fanout aspect of the PVA protocol is not implemented.</li>
<li>Client UDP search retry follows a linear backoff starting from 1 second
and stepping to 30 seconds.  cf. bucketInterval and nBuckets in client.cpp.</li>
<li>To level UDP search traffic, search retry may delay a PV for an extra
bucket if the difference in the number of PVs in the desired and subsequent
buckets is too large.</li>
<li>Client Context::hurryUp() expires the search bucket timer immediately,
saving up to bucketInterval seconds.</li>
<li>Each Value refers points to a pair of FieldDesc and FieldStorage in arrays
of the same.  Value::operator[] steps around in these arrays.</li>
<li>There is a hidden StructTop which holds the FieldStorage array and holds
a shared_ptr to the FieldDesc array to join ownership of the two.</li>
<li>TCP connection buffering will read up to tcp_readahead (cf. conn.h) bytes
while waiting for a complete header.  After a header is received,
the larger of tcp_readahead or the message body length is buffered.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PVXS</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html#including-pvxs-in-your-application">Including PVXS in your application</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="value.html">Value Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Details</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reporting-a-bug">Reporting a Bug</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#packet-capture">Packet Capture</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#release-policy">Release Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implementation-notes">Implementation Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="releasenotes.html">Release Notes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="example.html" title="previous chapter">Examples</a></li>
      <li>Next: <a href="releasenotes.html" title="next chapter">Release Notes</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021 Osprey DCS LLC.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/details.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>